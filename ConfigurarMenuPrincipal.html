<!DOCTYPE html>
<html>
<head>
  <base target="_top">
  
  <?!= HtmlService.createHtmlOutputFromFile('Estilos').getContent(); ?>

  <style>
    body {
      padding: 32px;
    }
    .tutorial-box {
      background-color: var(--cor-fundo-app);
      border: 1px dashed var(--cor-primaria);
      padding: 15px;
      border-radius: var(--border-radius);
      margin: 20px 0;
    }
    .tutorial-box h4 { 
      margin-top: 0; 
      color: var(--cor-primaria);
    }
    .card .action {
      float: right;
    }
  </style>
</head>
<body>
  
  <div class="card">
    <h3>Passo 1: O "MENU PRINCIPAL"</h3>
    <p style="text-align: center;">O primeiro passo é criar a "espinha dorsal" do seu estudo: a aba `MENU PRINCIPAL`.</p>
    
    <div class="tutorial-box">
      <h4>O que é isto?</h4>
      <p>Esta é a aba mais importante. É o seu **Registo de Pacientes**. Cada linha representa um paciente único, e todas as outras abas (Exames, Prescrição, RAMs) irão "puxar" os dados daqui.</p>
      
      <p>Este script irá criar automaticamente os 5 cabeçalhos essenciais que a ferramenta precisa para funcionar:</p>
      <ul style="font-weight: bold; padding-left: 20px;">
        <li>PACIENTE</li>
        <li>PRONTUÁRIO</li>
        <li>DATA DE NASCIMENTO</li>
        <li>SEXO</li>
        <li>IDADE GESTACIONAL</li>
      </ul>
    </div>
    
    <p>Clique abaixo para criar esta aba. Você poderá então preenchê-la com os dados dos seus pacientes antes de avançar.</p>
    
    <hr style="border: 0; border-top: 1px solid var(--cor-borda); margin: 20px 0;">
    
    <button class="action" onclick="criarAba()">Criar Aba e Avançar</button>
    
    <div id="loading"><p>A criar a aba `MENU PRINCIPAL`...</p></div>
    <div id="error"></div>
  </div>

  <script>
    function criarAba() {
      document.getElementById('loading').style.display = 'block';
      document.getElementById('error').style.display = 'none';
      
      google.script.run
        .withSuccessHandler(onAbaCriada)
        .withFailureHandler(mostrarErro)
        .executarSetupMenuPrincipal();
    }

    function onAbaCriada(resultado) {
      google.script.run
        .withSuccessHandler(google.script.host.close)
        .irParaEscolherModulos();
    }
    
    function mostrarErro(erro) {
      document.getElementById('loading').style.display = 'none';
      document.getElementById('error').textContent = 'Erro: ' + erro.message;
    }
  </script>
</body>
</html>
